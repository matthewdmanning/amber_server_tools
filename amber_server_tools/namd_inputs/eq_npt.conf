# Reference 1: NAMD config file auto-generated by NAMD GUI plugin (Jan Saam, saam@charite.de)
# Reference 2: http://ambermd.org/namd/namd_amber.html (Giambasu & Case, 2011)

# AMBER force field parameters (http://www.ks.uiuc.edu/Research/namd/2.11/ug/node13.html#2034)
amber					yes
set sysname            system_name
parmfile			    ../${sysname}.prmtop
ambercoor				../${sysname}.rst7

# Input files (http://www.ks.uiuc.edu/Research/namd/2.11/ug/node12.html#SECTION00062100000000000000)
set prevrun				previous_run
set inputprefix			../${sysname}_${prevrun}/${sysname}_${prevrun};# Tcl variable
bincoordinates			${inputprefix}.coor
binvelocities			${inputprefix}.vel
extendedSystem			${inputprefix}.xsc;	# Box dimensions & origin (replaces cellBasisVector1,2,3 & cellOrigin)

# Output files (http://www.ks.uiuc.edu/Research/namd/2.11/ug/node12.html#SECTION00062200000000000000)
set currentrun			current_run
set outputprefix		../${sysname}_${currentrun}/${sysname}_${currentrun};	# Tcl variable
outputname				${outputprefix};	# Default name used for output files
binaryoutput			yes;			    # AMBER ioutfm = 1
binaryrestart			yes;			    # AMBER ntxo = 2

set freq				100;				# Tcl variable
restartfreq				${freq};			# AMBER ntwr [timesteps]
DCDfreq					${freq};			# AMBER ntwx [timesteps]

# Standard output (http://www.ks.uiuc.edu/Research/namd/2.11/ug/node12.html#SECTION00062300000000000000)
outputEnergies			$freq;			# AMBER ntpr [timesteps]
outputPressure			$freq;			# AMBER ntpr [timesteps]

# Non-bonded force field parameters (http://www.ks.uiuc.edu/Research/namd/2.11/ug/node23.html#SECTION00082300000000000000)
cutoff					8.0;			# AMBER cut = 8.0 [angstroms]
switching				off;			# AMBER (does not use switching)
exclude					scaled1-4
1-4scaling				0.833333333;	# AMBER scee = 1.2; NAMD 1-4scaling = 1.0/scee
dielectric				1.0;			# AMBER dielc = 1.0
LJcorrection			yes;			# AMBER vdwmeth = 1

# PME parameters (http://www.ks.uiuc.edu/Research/namd/2.11/ug/node23.html#SECTION00082400000000000000)
PME						yes;			# AMBER ntb != 0
PMEGridSpacing			1.0;			# NAMD recommended value [angstroms]

# Non-bonded interaction distance-testing
# pairlistdist			10.0;			# NAMD pairlistdist - cutoff = AMBER skinnb = 2.0 [angstroms]; only applies when switching = on
stepspercycle			25;				# AMBER nsnb = 25 [timesteps]

# Bond constraint parameters (http://www.ks.uiuc.edu/Research/namd/2.11/ug/node27.html#SECTION00086100000000000000)
rigidBonds				all;			# AMBER ntc = 2
useSettle				on;				# AMBER jfastw = 0

# Restrain sulfur atoms to monolayer surface
constraints				on;
consref					../${sysname}.pdb;
conskfile				../${sysname}.pdb;
conskcol				O; # Select restraint scaling
constraintScaling		1.0;
selectConstraints		on;
selectConstrX			off;
selectConstrY			off;
selectConstrZ			on;

# Keep gold atoms fixed
fixedAtoms              on
fixedAtomsFile          ../$sysname.ref.pdb
fixedAtomsCol           O # Column to read from PDB; use 0 for unrestrained atoms

# Periodic boundary conditions (http://www.ks.uiuc.edu/Research/namd/2.11/ug/node33.html#SECTION000101100000000000000)
XSTfreq					${freq};			# Box dimensions over time [timesteps]
wrapAll					on;				# AMBER iwrap = 1

# Timestep parameters (http://www.ks.uiuc.edu/Research/namd/2.11/ug/node35.html#SECTION000103100000000000000)
firsttimestep			0;				# AMBER t = 0
timestep				2;				# NAMD [fs]; AMBER dt = 0.002 [ps]

# Initialization (http://www.ks.uiuc.edu/Research/namd/2.11/ug/node35.html#SECTION000103200000000000000)
COMmotion				yes;			# If NAMD COMmotion is "no", then initial velocities will be altered

# Multiple timestep parameters (http://www.ks.uiuc.edu/Research/namd/2.11/ug/node35.html#SECTION000103400000000000000)
fullElectFrequency		1;				# NAMD default = nonbondedFreq
nonbondedFreq			1;				# NAMD default = 1 [timesteps]

# Langevin dynamics parameters (http://www.ks.uiuc.edu/Research/namd/2.11/ug/node36.html#SECTION000104100000000000000)
set temp0				300;			# Tcl variable; AMBER temp0
langevin				on;				# AMBER ntt = 3
langevinDamping			1.0;			# AMBER gamma_ln [ps^-1]
langevinTemp			$temp0;			# AMBER temp0 [Kelvin]

# Pressure control (http://www.ks.uiuc.edu/Research/namd/2.11/ug/node37.html)
# useGroupPressure		yes;			# NAMD default = no
# useFlexibleCell		yes;			# NAMD default = no
# useConstantArea		no;				# NAMD default = no
# useConstantRatio		yes;			# NAMD default = no

# Nose-Hoover Langevin piston pressure control (http://www.ks.uiuc.edu/Research/namd/2.11/ug/node37.html#SECTION000105200000000000000)
LangevinPiston			on;				# AMBER ntp != 0
LangevinPistonTarget	1.01325;		# AMBER pres0 [bar]
LangevinPistonPeriod	200.0;			# NAMD recommended value [fs]
LangevinPistonDecay		100.0;			# NAMD recommended value [fs]
LangevinPistonTemp		$temp0;			# [Kelvin]
SurfaceTensionTarget	30.0;			# [dyn/cm]; requires "useFlexibleCell yes"

# Tcl scripting interface and features (http://www.ks.uiuc.edu/Research/namd/2.11/ug/node9.html#SECTION00052200000000000000)
run						500;			# AMBER nstlim [timesteps]
